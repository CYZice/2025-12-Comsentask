# YOLO目标检测实践笔记

## 一、环境配置过程

### 基础环境配置
- Python版本：3.10+
- PyTorch环境：torch>=2.0.0
- YOLO框架：ultralytics>=8.0.0

### 遇到的问题及解决方案

**问题1：Numpy版本冲突**
- 问题描述：pytorch环境和alum环境在Numpy的版本上存在冲突
- 解决方案：创建两个独立的虚拟环境，分别用于训练和数据增强

**问题2：CUDA环境配置**
- 问题描述：GPU训练时CUDA版本不匹配
- 解决方案：根据显卡型号选择合适的CUDA版本，重新安装对应的PyTorch版本

## 二、实践任务完成情况

### 任务1：预训练模型图像检测

使用YOLOv8预训练模型对图像进行目标检测，检测结果如下：

![任务1检测结果](../images/task1_detection_result.png)

*图1：使用预训练YOLOv8n模型检测公交车图像，成功检测到公交车、行人等目标*

### 任务2：视频目标检测

实现了多种视频检测模式：
- 摄像头实时检测
- 视频文件检测  
- 网络视频流检测

![环境配置截图](../images/屏幕截图 2025-12-13 185638.png)

*图2：YOLO环境配置和模型加载界面*

![检测过程截图](../images/屏幕截图 2025-12-13 185830.png)

*图3：实时视频检测过程*

### 任务3：自定义数据集训练

#### 数据集准备过程
- 在不同角度、不同环境拍摄5段5秒左右的视频
- 每隔15帧抽取一张图像
- 使用LabelImg进行目标标注
- 拆分成训练集和验证集（8:2比例）

#### 训练配置
- 基础模型：YOLOv8n
- 训练轮数：200 epochs
- 图像尺寸：640×640
- 批次大小：16

#### 训练结果

![训练过程截图](../images/屏幕截图 2025-12-13 185846.png)

*图4：自定义数据集训练过程*

![训练结果截图](../images/屏幕截图 2025-12-13 185918.png)

*图5：训练完成后的模型评估结果*

#### COCO数据集训练结果

![COCO训练结果](../images/coco训练/results.png)

*图6：在COCO数据集上的训练指标曲线*

![COCO混淆矩阵](../images/coco训练/confusion_matrix.png)

*图7：COCO数据集训练的混淆矩阵*

#### 自定义数据集训练指标

![自定义训练结果](../images/自定义数据集训练/results.png)

*图8：自定义数据集训练指标*

![自定义混淆矩阵](../images/自定义数据集训练/confusion_matrix.png)

*图9：自定义数据集训练的混淆矩阵*

#### 模型性能评估

训练结果优秀，对魔方识别的准确率达到95%以上。模型能够：
- 准确识别不同角度的魔方（打乱、未打乱)
- 在复杂背景下保持较高检测精度
- 实时检测速度达到25+ FPS



## 三、问题与解决方案

### 训练过程中的关键问题

| 问题描述 | 解决方案 | 效果评估 |
| -------- | -------- | -------- |
| **数据集数量不足** | 在150张已标注数据基础上，使用alum扩展到750张数据 | 训练效果良好，模型收敛正常 |
| **模型识别局限性** | 在已有模型上微调，补充100张魔方白面数据集 | 识别准确率提升至95%+ |
| **Numpy版本冲突** | 创建独立虚拟环境分别处理训练和数据增强 | 环境隔离，问题解决 |
|                    |                                                  |                            |

### 模型优化经验

1. **数据增强策略**
   - 使用旋转、缩放、亮度调整等多种增强方式
   - 保持数据分布的一致性
   - 验证集不参与增强，保证评估准确性

2. **训练参数调优**
   - 学习率：0.01（初始），采用余弦退火策略
   - 批次大小：16（平衡内存和稳定性）
   - 训练轮数：200（充分收敛）

3. **模型评估指标**
   - mAP@0.5：95.2%
   - mAP@0.5:0.95：87.6%
   - 推理速度：25+ FPS（GPU）

## 四、心得体会

### 技术收获

1. **YOLO算法理解**
   - 理解了YOLOv1的原理
2. **工程实践能力**
   - 掌握了PyTorch深度学习框架的使用
   - 学会了数据集的收集、标注和增强方法
   - 熟悉了模型训练、验证和测试的完整流程
3. **问题解决能力**
   - 学会了环境配置和依赖管理
   - 了解了如何处理数据收集问题

### 关键经验总结

1. **数据量越多，模型越好**
2. **训练策略优化**
   - 预训练模型微调比从零开始训练效果更好
   - 适当的学习率调度策略可以加速收敛
   - 早停机制可以防止过拟合
3. **模型评估与优化**
   - mAP是目标检测的核心评估指标
   - 混淆矩阵可以帮助分析模型的分类错误
   - 速度和精度需要根据实际情况权衡

### 实验成果

1. **模型性能指标**
   - 自定义数据集mAP@0.5：95.2%
   - COCO数据集mAP@0.5：42.8%（训练轮数较少)
   - 实时检测速度：25+ FPS

2. **功能实现**
   - 支持图像、视频、摄像头多种输入
   - 实现了自定义数据集训练流程
   - 完成了模型评估和结果可视化

### 后续学习计划

- 学习YOLOv8的网络架构细节
- 研究损失函数的设计原理
- 了解不同YOLO版本的演进过程

- 小目标检测优化

    